"use strict";(self.webpackChunkfacao_control=self.webpackChunkfacao_control||[]).push([[299],{1299:(st,b,d)=>{d.r(b),d.d(b,{MotoristaModule:()=>ot});var M=d(8605),u=d(6895),w=d(4006),l=d(90),C=d(470),q=d(7730),v=d(9132),f=d(1135),L=d(9603),t=d(4650),P=d(7438),E=d(8678),T=d(529),A=d(4004),y=d(2340),S=d(1622);const x=y.N.API_ENV;let Z=(()=>{class n{constructor(e,i){this._httpClient=e,this._tokenService=i}listDisponivel(){const e=this.getToken();return this._httpClient.get(`${x}/api/faccaocontrol/coleta/all`,{headers:e})}setColeta(e){const i=this.getToken(),o=JSON.stringify(e);return this._httpClient.post(`${x}/api/faccaocontrol/coleta/add`,o,{headers:i}).pipe((0,A.U)(a=>"OK"==a.data?1:0))}removeColeta(e){const i=this.getToken(),o=JSON.stringify(e);return this._httpClient.post(`${x}/api/faccaocontrol/coleta/remove`,o,{headers:i}).pipe((0,A.U)(a=>"OK"==a.data?1:0))}getToken(){const e=this._tokenService.getToken();return(new T.WM).append("x-access-token",e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.eN),t.LFG(S.B))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var N=d(6280),D=d(3380),U=d(4471);function R(n,r){1&n&&(t.TgZ(0,"div",9)(1,"h3"),t._uU(2,"Erro ao carregar os dados!"),t.qZA(),t.TgZ(3,"h3"),t._uU(4,"Tente novamente mais tarde."),t.qZA()())}function F(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e),t.oxw();const o=t.MAs(3),a=t.oxw();return t.KtG(a.limpaFiltro(o))}),t._UZ(1,"nb-icon",17),t.qZA()}}function I(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"nb-form-field")(2,"input",11,12),t.NdJ("keyup",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.filtroOP(o))}),t.qZA(),t.YNc(4,F,2,0,"button",13),t.TgZ(5,"button",14),t.NdJ("click",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.filtroOP(o))}),t._UZ(6,"nb-icon",15),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.filtroAtivo)}}function k(n,r){1&n&&(t.TgZ(0,"div")(1,"div",18)(2,"nb-card",19)(3,"nb-card-body")(4,"div",20)(5,"div",21),t._UZ(6,"img",22),t.qZA(),t.TgZ(7,"div",23)(8,"div",24)(9,"div")(10,"h4"),t._uU(11,"Ref:"),t.qZA()(),t.TgZ(12,"div",25),t._UZ(13,"nb-icon",26),t.qZA()(),t.TgZ(14,"div",27)(15,"span"),t._uU(16,"..."),t.qZA(),t.TgZ(17,"p")(18,"b"),t._uU(19,"Previs\xe3o:"),t.qZA()(),t.TgZ(20,"p")(21,"b"),t._uU(22,"Ciclo: "),t.qZA(),t._uU(23," / "),t.TgZ(24,"b"),t._uU(25,"OP: "),t.qZA()(),t.TgZ(26,"p")(27,"b"),t._uU(28,"Descri\xe7\xe3o:"),t.qZA()(),t.TgZ(29,"p")(30,"b"),t._uU(31,"Drop:"),t.qZA()(),t.TgZ(32,"p",28)(33,"b"),t._uU(34,"Pe\xe7as:"),t.qZA()()()()()()()()()),2&n&&(t.xp6(2),t.Q6J("nbSpinner",!0))}function $(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",37)(1,"button",38),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.setColeta(o))}),t._uU(2,"Coletar "),t._UZ(3,"nb-icon",39),t.qZA()()}}function J(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",37)(1,"button",40),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.removeColeta(o))}),t._uU(2,"Remover coleta "),t._UZ(3,"nb-icon",41),t.qZA()()}}function j(n,r){if(1&n&&(t.TgZ(0,"nb-card",30)(1,"nb-card-body")(2,"div",20)(3,"div",21),t._UZ(4,"img",31),t.qZA(),t.TgZ(5,"div",23)(6,"div",24)(7,"div",32)(8,"h4"),t._uU(9),t.qZA()()(),t.TgZ(10,"div",27)(11,"p",33)(12,"b"),t._uU(13,"Previs\xe3o de retorno:"),t.qZA(),t._uU(14),t.qZA(),t.TgZ(15,"p")(16,"b"),t._uU(17,"Ciclo:"),t.qZA(),t._uU(18),t.TgZ(19,"b"),t._uU(20,"OP:"),t.qZA(),t._uU(21),t.qZA(),t.TgZ(22,"p",34)(23,"b"),t._uU(24,"Descri\xe7\xe3o:"),t.qZA(),t._uU(25),t.qZA(),t.TgZ(26,"p",34)(27,"b"),t._uU(28,"Cole\xe7\xe3o:"),t.qZA(),t._uU(29),t.qZA(),t.TgZ(30,"p",28)(31,"b"),t._uU(32,"Pe\xe7as:"),t.qZA(),t._uU(33),t.qZA()(),t.YNc(34,$,4,0,"div",35),t.YNc(35,J,4,0,"ng-template",null,36,t.W1O),t.qZA()()()()),2&n){const e=r.$implicit,i=t.MAs(36),o=t.oxw(2);t.Q6J("accent",e.accent||"basic"),t.xp6(4),t.Q6J("lazyLoad",e.img)("defaultImage",o.defaultImage),t.xp6(5),t.hij("Ref: ",e.ref,""),t.xp6(5),t.hij(" ",e.previsao,""),t.xp6(4),t.hij(" ",e.ciclo," / "),t.xp6(3),t.hij(" ",e.op,""),t.xp6(4),t.hij(" ",e.descricao,""),t.xp6(4),t.hij(" ",e.drop,""),t.xp6(4),t.hij(" ",e.qnt,""),t.xp6(1),t.Q6J("ngIf",!e.checked)("ngIfElse",i)}}function B(n,r){if(1&n&&(t.TgZ(0,"div")(1,"div",18),t.YNc(2,j,37,12,"nb-card",29),t.ALo(3,"async"),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",t.lcZ(3,2,e.descOP$))("ngForTrackBy",e.trackByOP)}}function z(n,r){1&n&&(t.TgZ(0,"h4",42),t._uU(1,"Nenhum item encontrado.."),t.qZA())}let Q=(()=>{class n{constructor(e,i,o,a,g,m,h){this._route=e,this._setTitle=i,this._aponamentoSerice=o,this._motoristaService=a,this._userService=g,this._opsFilteredService=m,this._loadingService=h,this.datePipe=new u.uU("pt-Br"),this.loading=!1,this.loadingError=!1,this.filtroAtivo=!1,this.emptyList=!1,this.defaultImage="../../../../assets/not-found.png",this.imgUrl="https://indicium-lbm-client.s3-sa-east-1.amazonaws.com/images/",this.latitude=0,this.longitude=0,this.user="",this.cd_user=0,this.coletado=!1,this.qntOPs=0,this.qntPecas=0,this.descOPLoad=new f.X(!0),this.descOP=[],this.descOP$=new f.X(this.descOP)}ngOnInit(){this._setTitle.setTitle("Carregando...");let e=this._route.snapshot.paramMap.get("id");this.user=this._userService.getSession().nome,this.cd_user=this._userService.getSession().CD_USUARIO;let i=this._opsFilteredService.getFilter().apontamentoFilter;navigator.geolocation&&navigator.geolocation.getCurrentPosition(o=>{this.latitude=o.coords.latitude,this.longitude=o.coords.longitude},o=>console.error(`ERROR(${o.code}) ${o.message}`),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}),this._motoristaService.listDisponivel().subscribe({next:o=>{let a=JSON.parse(o.data);a=[void 0,"Todos",""].includes(i)?a.filter(s=>s.CD_LOCAL==+e):a.filter(s=>s.CD_LOCAL==+e&&s.DS_APONTAMENTO_DS==i),a.sort((s,p)=>s>p?1:-1);let g=!1;a.map(s=>{g="Coletado"==s.DS_APONTAMENTO_DS,this.descOP.push({cod:s.NR_CICLO+"-"+s.NR_OP+"-"+s.CD_REFERENCIA,NR_REDUZIDOOP:s.NR_REDUZIDOOP,cd_local:s.CD_LOCAL,local:s.DS_LOCAL,ciclo:+s.NR_CICLO,op:+s.NR_OP,ref:s.CD_REFERENCIA,previsao:new Date(+s.DT_PREVRETORNO).toLocaleString("pt-Br",{timeZone:"UTC"}).substring(0,10),Situacao:s.DS_APONTAMENTO_DS,checked:g,descricao:s.DS_GRUPO,drop:s.DS_DROP,img:this.imgUrl+s.CD_REFERENCIA.toString()+"/"+s.CD_REFERENCIA.toString()+"-1.jpg",link_ficha_tecnica:"",status:s.DS_APONTAMENTO_DS,status_color:s.DS_APONTAMENTO_DS.toLowerCase().replace(" ","-"),qnt:s.QT_OP}),this.descOP.map(p=>{p.accent="Em andamento"==p.status?"success":"Pendente"==p.status?"warning":"Em atraso"==p.status?"danger":"basic"})});let m=this.descOP[0].local.replace("COSTURA","").replace("CONSERTO","").replace("ESTAMPARIA","").replace("TERCEIROS","");this._setTitle.setTitle(m),this.qntOPs=this.descOP.length;let h=this.descOP.flatMap(s=>s.qnt||0);this.qntPecas=h.reduce((s,p)=>+s+ +p,0),this.descOP$.next(this.descOP),this.descOPLoad.next(!this.descOP.length)},error:o=>{console.error(o),this._setTitle.setTitle("Erro"),this.loadingError=!0}})}trackByOP(e,i){return i.NR_REDUZIDOOP}filtroOP(e){document.getElementById("filtro")?.focus();const i=e.target.value;this.filtroAtivo=!1,""==i?this.descOP$.next(this.descOP):(this.filtroAtivo=!0,this.descOP$.next(this.descOP.filter(o=>o.cod?.includes(i.toUpperCase()))),this.descOP$.subscribe(o=>{this.emptyList=!o.length}))}limpaFiltro(e){this.filtroAtivo=!1,e.value="",this.descOP$.next(this.descOP)}setColeta(e){this.loading=!0;let i=(new Date).toLocaleString("pt-Br").split(" "),o=i[0].split("/").reverse().join("-")+" "+i[1];this.novaColeta={NR_REDUZIDOOP:e.NR_REDUZIDOOP,CD_LOCAL:e.cd_local,DT_PREVRETORNO_HIST:e.previsao,QT_OP:e.qnt,DS_STATUS_HIST:e.status,CD_RESPONSAVEL:this.cd_user,USUARIO:this.user,DT_COLETA:o,GEOLOCALIZACAO:this.latitude+", "+this.longitude},this._motoristaService.setColeta(this.novaColeta).subscribe({next:a=>{a?(this.coletado=!0,this.submitiApontamento(e),this.setCheckedColeta(e.NR_REDUZIDOOP,this.coletado),this.loading=!1):this.coletado=!1},error:a=>{alert(`ERROR(${a.code}) ${a.message}`),this.coletado=!1,this.loading=!1}})}setCheckedColeta(e,i){this.descOP.map(o=>(o.NR_REDUZIDOOP==e&&(o.checked=i),o)),this.descOP$.next(this.descOP)}removeColeta(e){this.loading=!0;let i=(new Date).toLocaleString("pt-Br").split(" "),o=i[0].split("/").reverse().join("-")+" "+i[1];this.novaColeta={NR_REDUZIDOOP:e.NR_REDUZIDOOP,CD_LOCAL:e.cd_local,QT_OP:e.qnt,DT_PREVRETORNO_HIST:e.previsao,DS_STATUS_HIST:e.status,CD_RESPONSAVEL:this.cd_user,USUARIO:this.user,DT_COLETA:o,GEOLOCALIZACAO:this.latitude+", "+this.longitude},this._motoristaService.removeColeta(this.novaColeta).subscribe({next:a=>{!a||(this.coletado=!1,this.loading=!1,this.setCheckedColeta(e.NR_REDUZIDOOP,this.coletado))},error:a=>{this.loading=!1,alert(`ERROR(${a.code}) ${a.message}`)}})}submitiApontamento(e){let i=(new Date).toLocaleString("pt-Br").split(" "),o=i[0].split("/").reverse().join("-")+" "+i[1];this.novoApontamento={NR_REDUZIDOOP:e.NR_REDUZIDOOP,CD_LOCAL:e.cd_local,DT_PREVRETORNO:e.previsao,QT_OP:e.qnt,Status:e.status,CD_APONTAMENTO_DS:L.O.Coletado+1,DS_APONTAMENTO_DS:"Coletado",CD_USUARIO:this.cd_user,USUARIO:this.user,DT_MODIFICACAO:o,GEOLOCALIZACAO:this.latitude+", "+this.longitude},this.loading=!0,this._aponamentoSerice.setApontamento(this.novoApontamento).subscribe({next:a=>{this.loading=!1},error:a=>{alert(`ERROR(${a.code}) ${a.message}`)}}),this.loading=!1}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v.gz),t.Y36(P.H),t.Y36(E.y),t.Y36(Z),t.Y36(N.K),t.Y36(D.C),t.Y36(U.b))},n.\u0275cmp=t.Xpm({type:n,selectors:[["fc-descricao-faccao"]],decls:23,vars:13,consts:[["style","text-align: center;",4,"ngIf","ngIfElse"],["filter",""],[1,"toolbar-wrapper"],[1,"toolbar-info"],[1,"toolbar-value"],[1,"h6"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["listaVazia",""],[2,"text-align","center"],[1,"filter-wrapper"],["type","text","id","filtro","nbInput","","placeholder","Filtrar Ciclo, OP ou Ref",3,"keyup"],["filtro",""],["nbPrefix","","nbButton","","ghost","",3,"click",4,"ngIf"],["nbSuffix","","nbButton","","ghost","",3,"click"],["icon","search-outline","aria-label","pesquisar"],["nbPrefix","","nbButton","","ghost","",3,"click"],["icon","close-square-outline","aria-label","pesquisar"],[1,"card-wrapper"],["nbSpinnerStatus","primary",3,"nbSpinner"],[1,"c-body-wrapper"],[1,"c-img"],["src","../../../../assets/not-found.png","alt","op-img"],[1,"c-desc"],[1,"c-header"],[1,"bt-edit"],["icon","more-vertical-outline"],[1,"c-body"],[1,"c-qnt"],[3,"accent",4,"ngFor","ngForOf","ngForTrackBy"],[3,"accent"],["alt","op-img",3,"lazyLoad","defaultImage"],[1,"titulo"],[2,"font-size","15px"],[1,"desc-text"],["class","bt-coletar-wrapper",4,"ngIf","ngIfElse"],["coletado",""],[1,"bt-coletar-wrapper"],["nbButton","","status","success",1,"bt-coletar",3,"click"],["icon","paper-plane-outline","aria-label","pesquisar"],["nbButton","","status","danger",1,"bt-coletar",3,"click"],["icon","trash-2-outline","aria-label","pesquisar"],[1,"error-notfound"]],template:function(e,i){if(1&e&&(t.TgZ(0,"nb-layout")(1,"nb-layout-column"),t.YNc(2,R,5,0,"div",0),t.YNc(3,I,7,1,"ng-template",null,1,t.W1O),t.TgZ(5,"div",2)(6,"div",3)(7,"div",4)(8,"div"),t._uU(9," Qtd. OP's: "),t.qZA(),t.TgZ(10,"div",5),t._uU(11),t.qZA()(),t.TgZ(12,"div",4)(13,"div"),t._uU(14," Qtd. Pe\xe7as: "),t.qZA(),t.TgZ(15,"div",5),t._uU(16),t.ALo(17,"number"),t.qZA()()()(),t.YNc(18,k,35,1,"div",6),t.ALo(19,"async"),t.YNc(20,B,4,4,"div",7),t.YNc(21,z,2,0,"ng-template",null,8,t.W1O),t.qZA()()),2&e){const o=t.MAs(4),a=t.MAs(22);t.xp6(2),t.Q6J("ngIf",i.loadingError)("ngIfElse",o),t.xp6(9),t.hij(" ",i.qntOPs," "),t.xp6(5),t.hij(" ",t.Dn7(17,7,i.qntPecas,"1.0","pt-Br")," "),t.xp6(2),t.Q6J("ngIf",t.lcZ(19,11,i.descOPLoad)),t.xp6(2),t.Q6J("ngIf",!i.emptyList)("ngIfElse",a)}},dependencies:[u.sg,u.O5,C.z1,l.DPz,l.Asz,l.yKW,l.jBG,l.t3q,l.yyc,l.fMN,l.h8i,l.Aqw,l.dP_,l.Q7R,u.Ov,u.JJ],styles:["nb-layout-column[_ngcontent-%COMP%]{padding:0!important}.toolbar-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex:1;background-color:var(--input-basic-background-color);justify-content:space-around;padding:.75rem 4rem .5rem;border:1px solid var(--background-basic-color-3);border-right:none;border-left:none;border-radius:15px}.toolbar-info[_ngcontent-%COMP%]{display:flex;width:15em;justify-content:space-between;align-items:center;margin-top:10px}.toolbar-value[_ngcontent-%COMP%]{margin:0 10px;text-align:center}.toolbar-value[_ngcontent-%COMP%]   .h6[_ngcontent-%COMP%]{font-size:1.125rem;font-family:Open Sans,sans-serif;font-weight:700;line-height:1.5rem}.titulo[_ngcontent-%COMP%]{font-family:Trebuchet MS,Lucida Sans Unicode,Lucida Grande,Lucida Sans,Arial,sans-serif;text-align:center}.filter-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin:10px}.card-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center}.card-wrapper[_ngcontent-%COMP%]   nb-card[_ngcontent-%COMP%]{width:500px;margin:10px;box-shadow:#32325d40 0 6px 12px -2px,#0000004d 0 3px 7px -3px}.card-wrapper[_ngcontent-%COMP%]   nb-card-body[_ngcontent-%COMP%]{padding:0}.c-body-wrapper[_ngcontent-%COMP%]{display:flex;max-height:350px}.c-body-wrapper[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:22px;margin:5px 0}.c-body-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:small}.c-body-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:smaller}.c-body[_ngcontent-%COMP%]   .desc-text[_ngcontent-%COMP%]{font-size:12px;line-height:1;margin:7px 0}.c-img[_ngcontent-%COMP%]{min-width:35%;max-width:200px;display:flex;align-items:center}.c-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;max-width:180px;height:100%;object-fit:cover}.c-desc[_ngcontent-%COMP%]{width:-webkit-fill-available;margin-left:10px;padding:0 10px 10px;max-height:310px;display:flex;flex-direction:column;justify-content:space-between}.c-desc[_ngcontent-%COMP%]   .bt-edit[_ngcontent-%COMP%]{cursor:pointer}.c-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.bt-coletar[_ngcontent-%COMP%]{width:100%}@media (max-width: 375px){.titulo[_ngcontent-%COMP%]{font-size:25px}.filter-wrapper[_ngcontent-%COMP%]{margin-right:0}.c-body-wrapper[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.c-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:-webkit-fill-available;max-width:115px}}.error-notfound[_ngcontent-%COMP%]{text-align:center;margin-top:3em}@media (min-width: 375px) and (max-width: 475px){.titulo[_ngcontent-%COMP%]{font-size:25px}.c-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:-webkit-fill-available;max-width:132px}.toolbar-wrapper[_ngcontent-%COMP%]{padding:.75rem 1rem .5rem}.toolbar-info[_ngcontent-%COMP%]{margin-top:20px}}"],changeDetection:0}),n})();var Y=d(9219);function G(n,r){if(1&n&&(t.TgZ(0,"div"),t._UZ(1,"fc-card",5),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.Q6J("loading",!0)("title","...")("qnt_ops",0)("c_status",e)("qnt_atraso",0)("show_desc",!0)}}function H(n,r){if(1&n&&(t.TgZ(0,"div")(1,"div",3),t.YNc(2,G,2,6,"div",4),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.color)}}function K(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(e),t.oxw();const o=t.MAs(7),a=t.oxw();return t.KtG(a.limpaFiltro(o))}),t._UZ(1,"nb-icon",22),t.qZA()}}function V(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",6)(1,"h6",7),t._uU(2,"Filtros"),t.qZA(),t.TgZ(3,"div",8)(4,"div",9)(5,"nb-form-field")(6,"input",10,11),t.NdJ("keyup",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.filtroFaccao(o))}),t.qZA(),t.YNc(8,K,2,0,"button",12),t.TgZ(9,"button",13),t._UZ(10,"nb-icon",14),t.qZA()()()(),t.TgZ(11,"div",15)(12,"div",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.filtroApontamento("Dispon\xedvel para coleta"))}),t.TgZ(13,"div",17),t._uU(14," Pe\xe7as Dispon\xedveis para coleta: "),t.qZA(),t.TgZ(15,"button",18),t._uU(16),t.ALo(17,"number"),t.ALo(18,"async"),t.qZA()(),t.TgZ(19,"div",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.filtroApontamento("Coletado"))}),t.TgZ(20,"div",17),t._uU(21," Pe\xe7as Coletadas: "),t.qZA(),t.TgZ(22,"button",19),t._uU(23),t.ALo(24,"number"),t.ALo(25,"async"),t.qZA()(),t.TgZ(26,"div",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.filtroApontamento("Todos"))}),t.TgZ(27,"div",17),t._uU(28," Total de pe\xe7as: "),t.qZA(),t.TgZ(29,"button",20),t._uU(30),t.ALo(31,"number"),t.ALo(32,"async"),t.qZA()()()()}if(2&n){const e=t.oxw();t.xp6(8),t.Q6J("ngIf",e.filtroAtivo),t.xp6(8),t.hij(" ",t.Dn7(17,4,t.lcZ(18,8,e.qtDisponivel$),"1.0","pt-Br")," "),t.xp6(7),t.hij(" ",t.Dn7(24,10,t.lcZ(25,14,e.qtColetado$),"1.0","pt-Br")," "),t.xp6(7),t.hij(" ",t.Dn7(31,16,t.lcZ(32,20,e.qtTotal$),"1.0","pt-Br")," ")}}const W=function(n){return["/motorista/descricao/",n]};function X(n,r){if(1&n&&(t.TgZ(0,"div"),t._UZ(1,"fc-card",24),t.qZA()),2&n){const e=r.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("headerColor","header-color")("show_desc",i.show_desc)("title",e.name)("text_desc","Qnt. pe\xe7as")("qnt_ops",e.qnt)("c_status","")("qnt_atraso",e.qnt_pecas)("per_atraso",e.per_atraso)("routerLink",t.VKq(9,W,e.id))}}function tt(n,r){if(1&n&&(t.TgZ(0,"div")(1,"div",23),t.YNc(2,X,2,11,"div",4),t.ALo(3,"async"),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",t.lcZ(3,1,e.faccaoList$))}}function et(n,r){1&n&&(t.TgZ(0,"h4",25),t._uU(1,"Nenhum item encontrado.."),t.qZA())}const nt=[{path:"",component:(()=>{class n{constructor(e,i,o){this._setTitle=e,this._motoristaService=i,this._opsFilteredService=o,this.color=["info","warning","primary","success"],this.emptyList=!1,this.filtroAtivo=!1,this.show_desc=!0,this.listCodOPsDisponiveis=[],this.listOPsDisponiveis=[],this.resumoApontamento=[],this.qtDisponivel=0,this.qtDisponivel$=new f.X(this.qtDisponivel),this.qtColetado=0,this.qtColetado$=new f.X(this.qtColetado),this.qtTotal=0,this.qtTotal$=new f.X(this.qtTotal),this.localList=[],this.faccaoList=[],this.faccaoList$=new f.X(this.faccaoList)}ngOnInit(){this._setTitle.setTitle("Carregando..."),this._opsFilteredService.setFilter({origem:"",colecao:"",apontamentoFilter:""}),this._motoristaService.listDisponivel().subscribe({next:e=>{this.listOPsDisponiveis=JSON.parse(e.data),this.listOPsDisponiveis.forEach(i=>{"Dispon\xedvel para coleta"==i.DS_APONTAMENTO_DS?this.qtDisponivel+=+i.QT_OP:"Coletado"==i.DS_APONTAMENTO_DS&&(this.qtColetado+=+i.QT_OP),this.qtTotal+=i.QT_OP}),this.qtDisponivel$.next(this.qtDisponivel),this.qtColetado$.next(this.qtColetado),this.qtTotal$.next(this.qtTotal),this.setfaccaolist(this.listOPsDisponiveis),this._setTitle.setTitle("Motorista"),this.emptyList=!1},error:e=>console.error(e)})}setfaccaolist(e){this.faccaoList=[],this.localList=e.flatMap(c=>c.DS_LOCAL);let i=[];e.forEach(c=>{i.push({local:c.DS_LOCAL,qnt:c.QT_OP})});let o=[...new Set(this.localList)].filter(c=>""!==c),a=this.localList.reduce((c,_)=>(c[_]=(c[_]||0)+1,c),{}),g=i.reduce((c,_)=>(c[_.local]=(c[_.local]||0)+parseInt(_.qnt),c),{});this.localList.forEach(c=>{g[c]||(g[c]=0)});let m=Object.keys(g).map(c=>[c,g[c]]),h=0,p=0;o.map((c,_)=>{h=e.find(O=>O.DS_LOCAL==c)?.CD_LOCAL,p=+m.find(O=>O[0]==c)[1]||0,this.faccaoList.push({id:h,name:c,qnt:a[c],qnt_atraso:0,qnt_pecas:p,colecao:e.find(O=>O.DS_LOCAL==c)?.DS_CICLO,color:""})}),this.faccaoList.sort((c,_)=>c.qnt_pecas<_.qnt_pecas?1:_.qnt_pecas<c.qnt_pecas?-1:0),this.faccaoList.sort((c,_)=>c.qnt<_.qnt?1:_.qnt<c.qnt?-1:0),this.emptyList=!this.faccaoList.length,this.faccaoList$.next(this.faccaoList)}filtroApontamento(e){if(this._opsFilteredService.setFilter({origem:"",colecao:"",apontamentoFilter:e}),"Todos"==e)return void this.setfaccaolist(this.listOPsDisponiveis);let i=this.listOPsDisponiveis.filter(o=>o.DS_APONTAMENTO_DS==e);this.setfaccaolist(i)}filtroFaccao(e){document.getElementById("filtro")?.focus();const i=e.target.value;i?(this.filtroAtivo=!0,this.faccaoList$.next(this.faccaoList.filter(o=>o.name.includes(i.toUpperCase()))),this.faccaoList$.subscribe(o=>this.emptyList=!o.length)):(this.faccaoList$.next(this.faccaoList),this.filtroAtivo=!1)}limpaFiltro(e){this.filtroAtivo=!1,e.value="",this.faccaoList$.next(this.faccaoList)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(P.H),t.Y36(Z),t.Y36(D.C))},n.\u0275cmp=t.Xpm({type:n,selectors:[["fc-list-faccoes"]],decls:8,vars:4,consts:[[4,"ngIf","ngIfElse"],["allOPs",""],["listaVazia",""],[1,"cards-wrapper","loading"],[4,"ngFor","ngForOf"],[3,"loading","title","qnt_ops","c_status","qnt_atraso","show_desc"],[1,"filter-wrapper"],[1,"filter-title"],[1,"filter-menu-wrapper"],[1,"filter-dropdown"],["type","text","id","filtro-op","nbInput","","placeholder","Filtrar fac\xe7\xe3o",3,"keyup"],["filtro",""],["nbPrefix","","nbButton","","ghost","",3,"click",4,"ngIf"],["nbSuffix","","nbButton","","ghost",""],["icon","search-outline","aria-label","pesquisar"],[1,"qtd-wrapper"],[1,"toolbar-value",3,"click"],[1,"toolbar-subtitle"],["nbButton","",1,"h6","disponivel"],["nbButton","",1,"h6","coletado"],["nbButton","",1,"h6"],["nbPrefix","","nbButton","","ghost","",3,"click"],["icon","close-square-outline","aria-label","pesquisar"],[1,"cards-wrapper"],[3,"headerColor","show_desc","title","text_desc","qnt_ops","c_status","qnt_atraso","per_atraso","routerLink"],[2,"text-align","center"]],template:function(e,i){if(1&e&&(t.TgZ(0,"nb-layout")(1,"nb-layout-column"),t.YNc(2,H,3,1,"div",0),t.YNc(3,V,33,22,"ng-template",null,1,t.W1O),t.YNc(5,tt,4,3,"div",0),t.YNc(6,et,2,0,"ng-template",null,2,t.W1O),t.qZA()()),2&e){const o=t.MAs(4),a=t.MAs(7);t.xp6(2),t.Q6J("ngIf",i.listOPsDisponiveis.length<1)("ngIfElse",o),t.xp6(3),t.Q6J("ngIf",!i.emptyList)("ngIfElse",a)}},dependencies:[u.sg,u.O5,v.rH,Y.A,l.DPz,l.jBG,l.t3q,l.yyc,l.fMN,l.h8i,l.Aqw,l.dP_,u.Ov,u.JJ],styles:["nb-layout-column[_ngcontent-%COMP%]{padding:0!important}.cards-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.loading[_ngcontent-%COMP%]{margin-top:20px}.filter-wrapper[_ngcontent-%COMP%]{display:flex;margin:40px 15px 0;padding:10px;border:1px solid lightblue;border-radius:5px;background-color:var(--background-basic-color-2)}.filter-wrapper[_ngcontent-%COMP%]   .filter-title[_ngcontent-%COMP%]{font-weight:600;margin-top:-20px;background:linear-gradient(0deg,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 55%,var(--background-basic-color-2) 55%,var(--background-basic-color-2) 100%);width:max-content;padding:0 5px;-webkit-user-select:none;user-select:none}.filter-wrapper[_ngcontent-%COMP%]   .filter-menu-wrapper[_ngcontent-%COMP%]{margin-left:2em;display:flex;flex-wrap:wrap;align-items:center}.qtd-wrapper[_ngcontent-%COMP%]{display:flex;margin-left:10vw}.toolbar-value[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:column;justify-content:space-between;margin:0 10px;text-align:center}.toolbar-value[_ngcontent-%COMP%]   .toolbar-subtitle[_ngcontent-%COMP%]{font-size:1.25cqi}.toolbar-value[_ngcontent-%COMP%]   .h6[_ngcontent-%COMP%]{max-width:10vw;min-width:75px;margin:0 auto;font-size:1.125rem;font-family:Open Sans,sans-serif;font-weight:700;line-height:1.5rem;padding:10px;cursor:pointer}.toolbar-value[_ngcontent-%COMP%]   .disponivel[_ngcontent-%COMP%]{color:var(--color-success-new)}.toolbar-value[_ngcontent-%COMP%]   .coletado[_ngcontent-%COMP%]{color:var(--alert-success-background-color)}*[_ngcontent-%COMP%]{scrollbar-width:auto;scrollbar-color:#bdbdbd #ffffff}*[_ngcontent-%COMP%]::-webkit-scrollbar{width:9px}*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#bdbdbd;border-radius:10px}@media (max-width: 360px){.filter-wrapper[_ngcontent-%COMP%]{margin-right:0}.c-body-wrapper[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.c-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:-webkit-fill-available;max-width:115px}}@media (min-width: 360px) and (max-width: 475px){.filter-wrapper[_ngcontent-%COMP%]{margin:20px 0}.filter-wrapper[_ngcontent-%COMP%]   .filter-menu-wrapper[_ngcontent-%COMP%]{margin:0!important;justify-content:center}.filter-dropdown[_ngcontent-%COMP%]{margin:0 0 10px!important}.c-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:-webkit-fill-available;max-width:132px}.toolbar-wrapper[_ngcontent-%COMP%]{padding:.75rem 1rem .5rem}.c-qnt[_ngcontent-%COMP%]{margin-bottom:3px}}@media screen and (max-width: 475px){.filter-wrapper[_ngcontent-%COMP%]{flex-wrap:wrap}.toolbar-value[_ngcontent-%COMP%]   .toolbar-subtitle[_ngcontent-%COMP%]{font-size:4cqi}.qtd-wrapper[_ngcontent-%COMP%]{margin-top:2.5vw;margin-left:auto}}@media screen and (min-height: 900px){.list-viewport[_ngcontent-%COMP%]{height:800px}}"],changeDetection:0}),n})()},{path:"descricao/:id",component:Q}];let it=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[v.Bz.forChild(nt),v.Bz]}),n})(),ot=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[{provide:C.sN,useClass:C.TD}],imports:[u.ez,w.u5,it,q.q,C.mZ,M.Cl,l.T2N,l.zyh,l.V7y,l.KdK,l.nKr,l.BW0,l.uuI]}),n})()}}]);